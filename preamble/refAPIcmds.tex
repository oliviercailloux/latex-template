\usepackage{xstring}
\usepackage{pgffor}

\ExplSyntaxOn
\NewDocumentCommand{\extractlast}{O{.}mo}
 {
  \seq_set_split:Nnn \l_stroobants_string_seq { #1 } { #2 }
  \IfNoValueTF { #3 }
   {
    \seq_item:Nn \l_stroobants_string_seq { -1 }
   }
   {
    \tl_set:Nx #3 { \seq_item:Nn \l_stroobants_string_seq { -1 } }
   }
 }
\seq_new:N \l_stroobants_string_seq
\ExplSyntaxOff

\newbool{refAPITypewriter}
\newbool{refAPIShowPackage}
\newbool{refAPIShowField}
\newbool{refAPIShowMethod}
\newbool{refAPIShowParameters}
\pgfkeys{
	/refAPI/.is family,
	/refAPI/.cd,
	display string/.estore in = \refAPIDisplayString,
	base url/.estore in = \refAPIBaseUrl,
	parameters style/.estore in = \refAPIParametersStyle,
	typewriter/.is if = refAPITypewriter,
	show package/.is if = refAPIShowPackage,
	show field/.is if = refAPIShowField,
	show method/.is if = refAPIShowMethod,
	show parameters/.is if = refAPIShowParameters,
	default/.style = {
		display string =,
		typewriter = true,
		show package = false,
		show field = true,
		show method = true,
		show parameters = false,
	},
}

%Thx https://tex.stackexchange.com/a/34318
%Approach: define the following refAPI macros. AtSign (starts with at); Module (before unique / or empty); Method (after unique # if has ( or empty); Field (after unique # if no ( or empty if no #); FQName (between / and # or after / or before # or everything); FQNameSlashes (FQName with slashes instead of dots); Class (between last dot and #).
%The main argument specifies everything needed to build the URL and the default appearance (@ or no @â€¦), except possibly for default global variables such as base url. The default appearance can be changed with keys.
\newcommand{\jrefAPI}[2][]{%
	\pgfkeys{/refAPI/.cd, default, #1}%
	\edef\refAPIFull{#2}%
	\IfBeginWith{#2}{@}{%
		\edef\refAPIAtSign{@}%
		\StrBehind{#2}{@}[\refAPIWithoutAt]%
	}{%
		\edef\refAPIAtSign{}%
		\edef\refAPIWithoutAt{#2}%
	}%
	\IfSubStr{#2}{/}{%
	}{%
		\typeout{Missing slash!}
	}%
	\StrBefore{\refAPIWithoutAt}{/}[\refAPIBeforeFirstSlash]%
	\StrBehind{\refAPIWithoutAt}{/}[\refAPIAfterFirstSlash]%
	\IfSubStr{\refAPIAfterFirstSlash}{/}{%
		\edef\refAPIModule{\refAPIBeforeFirstSlash}%
		\StrBefore{\refAPIAfterFirstSlash}{/}[\refAPIPackage]%
		\StrBehind{\refAPIAfterFirstSlash}{/}[\refAPIClassAndRest]%
	}{%
		\edef\refAPIModule{}%
		\edef\refAPIPackage{\refAPIBeforeFirstSlash}%
		\edef\refAPIClassAndRest{\refAPIAfterFirstSlash}%
	}%
	\StrSubstitute{\refAPIPackage}{.}{/}[\refAPIPackageSlashes]%
	\IfSubStr{#2}{\#}{%
		\StrBehind{#2}{\#}[\refAPIAfterSharp]%
		\IfSubStr{\refAPIAfterSharp}{(}{%
			\StrBehind{#2}{\#}[\refAPIMethodWithParameters]%
		}{%
			\edef\refAPIMethodWithParameters{}%
		}%
	}{%
		\edef\refAPIMethodWithParameters{}%
	}%
	\StrSubstitute{\refAPIMethodWithParameters}{ }{}[\refAPIMethodWithParametersWithoutSpaces]%
	\StrBefore{\refAPIMethodWithParameters}{(}[\refAPIMethodWithoutParameters]%
	\IfSubStr{#2}{\#}{%
		\StrBehind{#2}{\#}[\refAPIAfterSharp]%
		\IfSubStr{\refAPIAfterSharp}{(}{%
			\edef\refAPIField{}%
		}{%
			\StrBehind{#2}{\#}[\refAPIField]%
		}%
	}{%
		\edef\refAPIField{}%
	}%
	\IfSubStr{\refAPIClassAndRest}{\#}{%
		\StrBefore{\refAPIClassAndRest}{\#}[\refAPIClass]%
	}{%
		\edef\refAPIClass{\refAPIClassAndRest}%
	}%
	%
	%\refAPIPrintAll%
	%
	\edef\refAPITarget{\refAPIBaseUrl}%
	\IfEq{\refAPIModule}{}{%
	}{%
		\appto\refAPITarget{\refAPIModule}%
		\appto\refAPITarget{/}%
	}%
	\appto\refAPITarget{\refAPIPackageSlashes}%
	\appto\refAPITarget{/}%
	\appto\refAPITarget{\refAPIClass}%
	\appto\refAPITarget{.html}%
	\IfEq{\refAPIField}{}{%
	}{%
		\appto\refAPITarget{\#\refAPIField}%
	}%
	\IfEq{\refAPIMethodWithParametersWithoutSpaces}{}{%
	}{%
		\IfEq{\refAPIParametersStyle}{hyphen}{%
			\StrSubstitute{\refAPIMethodWithParametersWithoutSpaces}{(}{-}[\refAPIMethodWithParametersWithoutSpacesWithHyphens]%
			\StrSubstitute{\refAPIMethodWithParametersWithoutSpacesWithHyphens}{,}{-}[\refAPIMethodWithParametersWithoutSpacesWithHyphens]%
			\StrSubstitute{\refAPIMethodWithParametersWithoutSpacesWithHyphens}{)}{-}[\refAPIMethodWithParametersWithoutSpacesWithHyphens]%
			\appto\refAPITarget{\#\refAPIMethodWithParametersWithoutSpacesWithHyphens}%
		}{%
			\appto\refAPITarget{\#\refAPIMethodWithParametersWithoutSpaces}%
		}%
	}%
	%
	\edef\refAPILinkText{}%
	\appto\refAPILinkText{\refAPIAtSign}%
	\ifbool{refAPIShowPackage}{%
		\appto\refAPILinkText{\refAPIPackage}%
		\appto\refAPILinkText{.}%
	}{%
	}%
	\appto\refAPILinkText{\refAPIClass}%
	\ifbool{refAPIShowField}{%
		\IfEq{\refAPIField}{}{%
		}{%
			\appto\refAPILinkText{\#\refAPIField}%
		}%
	}{%
	}%
	\ifbool{refAPIShowMethod}{%
		\ifbool{refAPIShowParameters}{%
			\IfEq{\refAPIMethodWithParameters}{}{%
			}{%
				\appto\refAPILinkText{\#\refAPIMethodWithParameters}%
			}%
		}{%
			\IfEq{\refAPIMethodWithoutParameters}{}{%
			}{%
				\appto\refAPILinkText{\#\refAPIMethodWithoutParameters}%
			}%
		}%
	}{%
	}%
	%
	\IfEq{\refAPIDisplayString}{}{%
		\ifbool{refAPITypewriter}{%
			\href{\refAPITarget}{\texttt{\refAPILinkText}}%
		}{%
			\href{\refAPITarget}{\refAPILinkText}%
		}%
	}{%
		\href{\refAPITarget}{\refAPIDisplayString}%
	}%
}

\newcommand{\refAPIPrintAll}{%
	\begin{description}
		\item[BaseUrl] \foreach \sfx in {BaseUrl}{\csname refAPI\sfx\endcsname}
		\foreach \sfx in {Full, AtSign, Module, MethodWithParameters, MethodWithParametersWithoutSpaces, MethodWithoutParameters, Field, Package, PackageSlashes, Class}{\item[\sfx] \csname refAPI\sfx\endcsname}
	\end{description}%
}

%Standard HTML RenderKit : https://docs.oracle.com/javaee/7/javaserver-faces-2-2/renderkitdocs/HTML_BASIC/javax.faces.Inputjavax.faces.Text.html
%\newcommand{\jsftag}[2][]{\jrefAPI{base url = https://docs.oracle.com/javaee/7/javaserver-faces-2-2/vdldocs-facelets/, full, prefix=:, #1}}


